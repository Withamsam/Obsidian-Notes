---
creation date: May 7th 2023
last modified date: May 7th 2023
aliases: []
tags: #ðŸ“•
---

Primary Categories: 
Secondary Categories:  
Links: [[02 - Internal Enumeration]]
Search Tag: #ðŸ“•  

# [[Post-Exploitation Enumeration]]  
___

## Description:  
Exploring our attack surface after we have exploited a machine with a shell is vital to do. When we first access a machine its like we are staring into blackness. Enumeration at this point fills in those gaps by finding things like:
- Users and groups
- Hostnames
- Routing tables
- Network shares
- Network services
- Applications and banners
- Firewall configuration
- Service settings and audit configurations
- SNMP and DNS details
- Hunting for credentials (saved on web browsers or client applications)
- etc...

---
## Linux
### System Info
#### OS Version
1. Checking `/etc/` for any folders with `release` in the name:
```bash
ls /etc/*-release
```
2. Printing file contents: 
```bash
cat /etc/<WHATEVER_WE_FOUND_ABOVE>
```

#### System Name
```bash
hostname
```

#### Users and Passwords
```bash
cat /etc/passwd
```

```bash
cat /etc/group
```

- This will contain the **hashed** passwords for users if we can read this we MIGHT be able to crack them with an offline attack
```bash
cat /etc/shadow
```

#### Mail Directory
```bash
ls -lh /var/mail/
```

#### Installed Applications
```bash
ls -lh /usr/bin
```

```bash
ls -lh /sbin/
```

#### Installed Packages
- RPM-based Linux distros (Fedora, CentOS, etc...)
```bash
rpm -qa
```

- Debian-based Linux distros (Kali, Ubuntu, etc...)
```bash
dpkg -l
```

### User Details
#### Who Is Logged In & What They Are Doing
```bash
w
```
- This will also show users who are logged in remotely with their IP's
- Also will show what they are currently doing / if they are active / idle time

#### Who Has Signed In
```bash
last
```
- Shows how long they were logged in for and when

#### Real and Effective User and Group
```bash
id
```

#### What SUDO Commands Current User Has
```
sudo -l
```
- Will list all SUDO commands that we can use with our current account.

### Network Details
#### IP Addresses
```bash
ip a s
```
- This is shorthand for `ip address show`
- Newer commands replacing `ifconfig -a` (package is no longer being maintained)

#### DNS Servers
```bash
cat /etc/resolv.conf
```
- Nameservers listed are our current DNS Servers

#### Programs Listening Over TCP
```bash
sudo netstat -plt
```
- **Netstat** contains a ton of information
- Note: We need to uses `sudo` if we want it to display the **PID/Program** otherwise it will be blank in that section

#### Show All TCP/UDP Listening & Established Connections
```bash
sudo netstat -atupn
```
or
```bash
lsof -i
```

### Running Services
#### All Running Services
```bash
ps -ef
```
or
```bash
ps aux
```
- Consider piping into `grep` to narrow your search as its a lot of info

#### Forest View Of Processes
- Gives and ASCII representation for how the processes relate to each other:
```bash
ps axjf
```

---
## Windows
### System Info
```CMD
systeminfo.exe
```
- Contains a large list of information:
	- OS Name
	- OS Version
	- Domain
	- Hotfix(s)
	- Network Cards
	- etc...

#### Check Installed Updates
```CMD
wmic qfe get Caption, Description
```
- Will help you determine how often a system if patched

#### Installed and Current Running Services
```CMD
net start
```

- Just Installed Programs
```CMD
wmic product get name,version,vendor
```

### Users
#### Current User Privileges
```CMD
whoami /priv
```

#### Current Users Groups
```CMD
whoami /groups
```

#### View All Users
```CMD
net user
```

#### Discover Available Groups
- If apart of an AD Controller:
```CMD
net group
```

- If not apart of an AD Controller:
```CMD
net localgroup
```

#### List Users Apart of Local Admin Group
```CMD
net localgroup administrators
```

#### Checking Local Account Settings
```CMD
net accounts
```
- Will contain things like:
	- Force Log Off Users Timer
	- Min/Max password age
	- Length of password history
	- Lockout threshold
	- etc...

### Networking
#### Checking All Network Related Settings 
```CMD
ipconfig /all
```

#### Checking ESTABLISHED & LISTENING Port Information
```CMD
netstat -abno
```
- Switch Options:
	- `a` = Display all listening and active ports
	- `b` = Finds the binary involved in the connection
	- `n` = Avoids resolving IP address so we can see IP and Ports
	- `o` = Shows PID's

#### Discovering Other Systems On The Same LAN
```CMD
arp -a
```
- Note the other machines would have to have recently communicated so its possible not all will show up here
- Subnet Broadcast IP's:
	- 10.10.255.255

#### Checking SMB Shares
```CMD
net share
```


___

## Resources:

| Hyperlink | Info |
| --------- | ---- |


Created Date: May 7th 2023 (11:17 am)  
Last Modified Date: <%+tp.file.last_modified_date("MMMM Do YYYY (hh:ss a)")%>
